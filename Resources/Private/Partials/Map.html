<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
			xmlns:sf="http://typo3.org/ns/Evoweb/StoreFinder/ViewHelpers"
			data-namespace-typo3-fluid="true">

<f:section name="content">
<script type="text/javascript">
	var mapConfiguration = {<f:format.raw><sf:minify>
		active: true,
		zoom: '{center.zoom}',
        apiConsoleKey: '{settings.apiConsoleKey}',
		<f:for each="{settings.mapConfiguration}" as="configuration" key="name">{name}: '{configuration}',</f:for>
		<f:if condition="{center.latitude}">
		center: {
			lat: <f:format.number decimals="7">{center.latitude}</f:format.number>,
			lng: <f:format.number decimals="7">{center.longitude}</f:format.number>
		},
		</f:if>
		afterSearch: {afterSearch}
	</sf:minify></f:format.raw>};

	var locations = [<f:format.raw><f:for each="{locations}" as="location" iteration="loop">
		<sf:minify><f:format.raw>{</f:format.raw>
			name: '{location.name}',
			lat: {location.latitude},
			lng: {location.longitude},
			information: <f:format.raw>{</f:format.raw>
				uid: '{location.uid}',
				name: '{location.name->f:format.json()}',
				storeid: '{location.storeid}',
				address: '{location.address->f:format.json()}',
				additionaladdress: '{location.additionaladdress->f:format.json()}',
				city: '{location.city->f:format.json()}',
				person: '{location.person}',
				zipcode: '{location.zipcode}',
				products: '{location.products->f:format.json()}',
				email: '{location.email}',
				phone: '{location.phone}',
				mobile: '{location.mobile}',
				fax: '{location.fax}',
				hours: '{location.hours}',
				url: '{location.url}',
				notes: '{location.notes->f:format.json()}',
				icon: '{location.icon}',
				state: '{location.state}',
				country: '{location.country}',
				image: '<f:if condition="{location.image}"><f:for each="{location.image}" as="image">{f:uri.image(src: image.uid, width: 70, treatIdAsReference: 1)}</f:for></f:if>',
				media: '{location.media}',
				lat: {location.latitude},
				lng: {location.longitude}
			}
		}</sf:minify><f:if condition="{loop.isLast}"><f:then/><f:else>,</f:else></f:if></f:if></f:for>
	</f:format.raw>];
</script>

<script id="templateInfoWindow" type="text/html">
	<div class="infoWindow group" style="width: 320px; height: 180px;" data-uid="{{<f:format.raw>uid</f:format.raw>}}">
		<div class="storename"><strong>{{<f:format.raw>title</f:format.raw>}}</strong></div>
		<div class="right">
			<div class="image">{{<f:format.raw>#image</f:format.raw>}}<img src="{{<f:format.raw>image</f:format.raw>}}"/>{{<f:format.raw>/image</f:format.raw>}}</div>
			<div class="displayRoute">
				<a href="https://maps.google.com/?daddr={{<f:format.raw>lat</f:format.raw>}},{{<f:format.raw>lng</f:format.raw>}}" target="_blank"><f:translate key="route"/></a>
			</div>
		</div>
		<div class="left">
			<div class="company">{{<f:format.raw>company</f:format.raw>}}</div>
			<div class="firstName">{{<f:format.raw>firstname</f:format.raw>}}</div>
			<div class="lastName">{{<f:format.raw>lastname</f:format.raw>}}</div>
			<div class="address">{{<f:format.raw>address</f:format.raw>}}</div>
			<div class="city">{{<f:format.raw>zipcode</f:format.raw>}} {{<f:format.raw>city</f:format.raw>}}</div>
			<div class="country">{{<f:format.raw>country</f:format.raw>}}</div>
			<div class="phone">{{<f:format.raw>phone</f:format.raw>}}</div>
			<div class="mobile">{{<f:format.raw>mobile</f:format.raw>}}</div>
			<div class="fax">{{<f:format.raw>fax</f:format.raw>}}</div>
			<div class="email">{{<f:format.raw>email</f:format.raw>}}</div>
			<div class="hours">{{<f:format.raw>hours</f:format.raw>}}</div>
			<div class="url">{{<f:format.raw>url</f:format.raw>}}</div>
		</div>
		<div class="clearfix"></div>
	</div>
</script>

<h3>{settings.storeTitle} <f:translate key="foundText" arguments="{0: 2}"/></h3>

<div id="tx_storefinder_map" style="height: {mapSize.height}; width: {mapSize.width};"></div>
</f:section>

</html>
