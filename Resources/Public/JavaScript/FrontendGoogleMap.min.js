!function r(a,s,p){function l(e,t){if(!s[e]){if(!a[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(c)return c(e,!0);var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}var o=s[e]={exports:{}};a[e][0].call(o.exports,function(t){return l(a[e][1][t]||t)},o,o.exports,r,a,s,p)}return s[e].exports}for(var c="function"==typeof require&&require,t=0;t<p.length;t++)l(p[t]);return l}({1:[function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o,a=t("./FrontendMap");function s(){return null!==o&&o.apply(this,arguments)||this}new(o=a.default,r(s,o),s.prototype.initializeMap=function(){var t,n=this;t=void 0!==this.mapConfiguration.center?new google.maps.LatLng(this.mapConfiguration.center.lat,this.mapConfiguration.center.lng):new google.maps.LatLng(0,0);var e={zoom:this.mapConfiguration.zoom,center:t,disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE}};this.map=new google.maps.Map(document.getElementById("tx_storefinder_map"),e),0===this.mapConfiguration.afterSearch&&navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){var e={lat:t.coords.latitude,lng:t.coords.longitude};n.map.setCenter(e)})},s.prototype.initializeLayer=function(){function t(t,e,n){var i=o.call(this)||this;return i.svgUri=t,i.bounds=e,i.map=n,i}var o,i;function e(t,e){var n=i.call(this,t)||this;return n.map=e,n}this.OverlayView=(o=google.maps.OverlayView,r(t,o),t.prototype.onAdd=function(){var t=document.createElement("div");t.id="svgLayer",t.style.position="absolute";var e=document.createElement("img");e.src=this.svgUri,e.style.width="100%",e.style.height="100%",t.appendChild(e),this.imageContainer=t,this.getPanes().overlayLayer.appendChild(this.imageContainer)},t.prototype.draw=function(){var t=this.getProjection(),e=t.fromLatLngToDivPixel(this.bounds.getSouthWest()),n=t.fromLatLngToDivPixel(this.bounds.getNorthEast()),i=this.imageContainer;i.style.left=e.x+"px",i.style.top=n.y+"px",i.style.width=n.x-e.x+"px",i.style.height=e.y-n.y+"px"},t.prototype.onRemove=function(){this.imageContainer.parentNode.removeChild(this.imageContainer),this.imageContainer=null},t.prototype.hide=function(){this.setMap(null)},t.prototype.show=function(){this.setMap(this.map)},t.prototype.toggleDOM=function(){this.getMap()?this.setMap(null):this.setMap(this.map)},t),this.Marker=(i=google.maps.Marker,r(e,i),e.prototype.hide=function(){this.setMap(null)},e.prototype.show=function(){this.setMap(this.map)},e.prototype.toggleDOM=function(){this.getMap()?this.setMap(null):this.setMap(this.map)},e),-1<this.mapConfiguration.apiV3Layers.indexOf("traffic")&&(new google.maps.TrafficLayer).setMap(this.map),-1<this.mapConfiguration.apiV3Layers.indexOf("bicycling")&&(new google.maps.BicyclingLayer).setMap(this.map),-1<this.mapConfiguration.apiV3Layers.indexOf("kml")&&new google.maps.KmlLayer({url:this.mapConfiguration.kmlUrl}).setMap(this.map)},s.prototype.showInformation=function(t,e){"function"==typeof this.mapConfiguration.renderSingleViewCallback?this.mapConfiguration.renderSingleViewCallback(t,this.infoWindowTemplate):(this.infoWindow.close(),this.infoWindow.setContent(this.renderInfoWindowContent(t)),this.infoWindow.setPosition(e.getPosition()),this.infoWindow.open(this.map,e))},s.prototype.createMarker=function(t){var e=this,n="";t.information.icon?n=t.information.icon:this.mapConfiguration.hasOwnProperty("markerIcon")&&(n=this.mapConfiguration.markerIcon);var i={title:t.name,position:new google.maps.LatLng(t.lat,t.lng),icon:n},o=new this.Marker(i,this.map);t.hidden?o.hide():o.show(),o.addListener("click",function(){e.showInformation(t,o)}),t.marker=o},s.prototype.createLayer=function(t){var e=new google.maps.LatLngBounds(new google.maps.LatLng(t.lat-.005,t.lng-.01),new google.maps.LatLng(t.lat+.005,t.lng+.01)),n=new this.OverlayView(t.information.layer,e,this.map);t.hidden?n.hide():n.show(),t.marker=n},s.prototype.initializeInfoWindow=function(){this.infoWindow=new google.maps.InfoWindow},s.prototype.closeInfoWindow=function(){this.infoWindow.close()},s.prototype.openInfoWindow=function(t){google.maps.event.trigger(this.locations[t].marker,"click")},s.prototype.loadScript=function(){var t=this,e="https://maps.googleapis.com/maps/api/js?v=3.exp",n="&key="+this.mapConfiguration.apiConsoleKey;""!==t.mapConfiguration.language&&(n+="&language="+t.mapConfiguration.language),t.mapConfiguration.hasOwnProperty("apiUrl")&&(e=t.mapConfiguration.apiUrl);var i=$.Deferred(),o=$("<script/>",{src:e+n,crossorigin:""}).appendTo("head");i.resolve(o),$.when(i.promise()).done(function(){window.requestAnimationFrame(function t(){"undefined"!=typeof google?this.postLoadScript():window.requestAnimationFrame(t.bind(this))}.bind(t))}).fail(function(){console.log("Failed loading resources.")})},s)},{"./FrontendMap":2}],2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("mustache"),o=(r.prototype.initializeMap=function(){},r.prototype.initializeLayer=function(){},r.prototype.renderInfoWindowContent=function(t){return i.render(this.infoWindowTemplate,t.information)},r.prototype.createMarker=function(t){},r.prototype.createLayer=function(t){},r.prototype.processLocation=function(t){t.marker||(this.locationIndex++,t.information.index=this.locationIndex,""!==t.information.layer?this.createLayer(t):this.createMarker(t))},r.prototype.initializeLocations=function(){this.locations.map(this.processLocation.bind(this))},r.prototype.initializeInfoWindow=function(){},r.prototype.closeInfoWindow=function(){},r.prototype.openInfoWindow=function(t){},r.prototype.initializeListEvents=function(){var n=this;$(document).on("click",".tx-storefinder .resultList > li",function(t,e){n.openInfoWindow(e.data("index"))})},r.prototype.initializeTemplates=function(){var n=this;this.infoWindowTemplate=$("#templateInfoWindow").html(),i.parse(this.infoWindowTemplate),$(document).on("click",".tx-storefinder .infoWindow .close",function(t,e){"function"==typeof n.mapConfiguration.renderSingleViewCallback?n.mapConfiguration.handleCloseButtonCallback(e):n.closeInfoWindow()})},r.prototype.postLoadScript=function(){this.initializeMap(),this.initializeLayer(),this.initializeLocations(),this.initializeInfoWindow(),this.initializeTemplates(),this.initializeListEvents()},r.prototype.loadScript=function(){},r);function r(){this.mapConfiguration={active:!1,afterSearch:0,center:{lat:0,lng:0},zoom:18,apiConsoleKey:"",apiUrl:"",language:"",markerIcon:"",apiV3Layers:"",kmlUrl:"",renderSingleViewCallback:null,handleCloseButtonCallback:null},this.locations=[],this.locationIndex=0,this.infoWindowTemplate="","object"==typeof window.mapConfiguration&&window.mapConfiguration.active&&(this.mapConfiguration=window.mapConfiguration),this.mapConfiguration&&("object"==typeof window.locations&&(this.locations=window.locations),this.loadScript())}n.default=o},{mustache:3}],3:[function(t,e,n){var i,o;i=this,o=function(){"use strict";var e=Object.prototype.toString,b=Array.isArray||function(t){return"[object Array]"===e.call(t)};function c(t){return"function"==typeof t}function M(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function u(t,e){return null!=t&&"object"==typeof t&&e in t}var i=RegExp.prototype.test;var o=/\S/;function W(t){return e=o,n=t,!i.call(e,n);var e,n}var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var I=/\s*/,O=/\s+/,T=/\s*=/,U=/\s*\}/,z=/#|\^|\/|>|\{|&|=|!/;function r(t,e){if(!t)return[];var n,i,o,r=!1,a=[],s=[],p=[],l=!1,c=!1,u="",f=0;function h(){if(l&&!c)for(;p.length;)delete s[p.pop()];else p=[];c=l=!1}function d(t){if("string"==typeof t&&(t=t.split(O,2)),!b(t)||2!==t.length)throw new Error("Invalid tags: "+t);n=new RegExp(M(t[0])+"\\s*"),i=new RegExp("\\s*"+M(t[1])),o=new RegExp("\\s*"+M("}"+t[1]))}d(e||P.tags);for(var g,m,y,w,v,C,k=new E(t);!k.eos();){if(g=k.pos,y=k.scanUntil(n))for(var L=0,x=y.length;L<x;++L)W(w=y.charAt(L))?(p.push(s.length),u+=w):(r=c=!0,u+=" "),s.push(["text",w,g,g+1]),g+=1,"\n"===w&&(h(),u="",f=0,r=!1);if(!k.scan(n))break;if(l=!0,m=k.scan(z)||"name",k.scan(I),"="===m?(y=k.scanUntil(T),k.scan(T),k.scanUntil(i)):"{"===m?(y=k.scanUntil(o),k.scan(U),k.scanUntil(i),m="&"):y=k.scanUntil(i),!k.scan(i))throw new Error("Unclosed tag at "+k.pos);if(v=">"==m?[m,y,g,k.pos,u,f,r]:[m,y,g,k.pos],f++,s.push(v),"#"===m||"^"===m)a.push(v);else if("/"===m){if(!(C=a.pop()))throw new Error('Unopened section "'+y+'" at '+g);if(C[1]!==y)throw new Error('Unclosed section "'+C[1]+'" at '+g)}else"name"===m||"{"===m||"&"===m?c=!0:"="===m&&d(y)}if(h(),C=a.pop())throw new Error('Unclosed section "'+C[1]+'" at '+k.pos);return function(t){for(var e,n=[],i=n,o=[],r=0,a=t.length;r<a;++r)switch((e=t[r])[0]){case"#":case"^":i.push(e),o.push(e),i=e[4]=[];break;case"/":o.pop()[5]=e[2],i=0<o.length?o[o.length-1][4]:n;break;default:i.push(e)}return n}(function(t){for(var e,n,i=[],o=0,r=t.length;o<r;++o)(e=t[o])&&("text"===e[0]&&n&&"text"===n[0]?(n[1]+=e[1],n[3]=e[3]):(i.push(e),n=e));return i}(s))}function E(t){this.string=t,this.tail=t,this.pos=0}function a(t,e){this.view=t,this.cache={".":this.view},this.parent=e}function t(){this.cache={}}E.prototype.eos=function(){return""===this.tail},E.prototype.scan=function(t){var e=this.tail.match(t);if(!e||0!==e.index)return"";var n=e[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},E.prototype.scanUntil=function(t){var e,n=this.tail.search(t);switch(n){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=e.length,e},a.prototype.push=function(t){return new a(t,this)},a.prototype.lookup=function(t){var e,n,i,o=this.cache;if(o.hasOwnProperty(t))e=o[t];else{for(var r,a,s,p=this,l=!1;p;){if(0<t.indexOf("."))for(r=p.view,a=t.split("."),s=0;null!=r&&s<a.length;)s===a.length-1&&(l=u(r,a[s])||(n=r,i=a[s],null!=n&&"object"!=typeof n&&n.hasOwnProperty&&n.hasOwnProperty(i))),r=r[a[s++]];else r=p.view[t],l=u(p.view,t);if(l){e=r;break}p=p.parent}o[t]=e}return c(e)&&(e=e.call(this.view)),e},t.prototype.clearCache=function(){this.cache={}},t.prototype.parse=function(t,e){var n=this.cache,i=t+":"+(e||P.tags).join(":"),o=n[i];return null==o&&(o=n[i]=r(t,e)),o},t.prototype.render=function(t,e,n,i){var o=this.parse(t,i),r=e instanceof a?e:new a(e,void 0);return this.renderTokens(o,r,n,t,i)},t.prototype.renderTokens=function(t,e,n,i,o){for(var r,a,s,p="",l=0,c=t.length;l<c;++l)s=void 0,"#"===(a=(r=t[l])[0])?s=this.renderSection(r,e,n,i):"^"===a?s=this.renderInverted(r,e,n,i):">"===a?s=this.renderPartial(r,e,n,o):"&"===a?s=this.unescapedValue(r,e):"name"===a?s=this.escapedValue(r,e):"text"===a&&(s=this.rawValue(r)),void 0!==s&&(p+=s);return p},t.prototype.renderSection=function(t,e,n,i){var o=this,r="",a=e.lookup(t[1]);if(a){if(b(a))for(var s=0,p=a.length;s<p;++s)r+=this.renderTokens(t[4],e.push(a[s]),n,i);else if("object"==typeof a||"string"==typeof a||"number"==typeof a)r+=this.renderTokens(t[4],e.push(a),n,i);else if(c(a)){if("string"!=typeof i)throw new Error("Cannot use higher-order sections without the original template");null!=(a=a.call(e.view,i.slice(t[3],t[5]),function(t){return o.render(t,e,n)}))&&(r+=a)}else r+=this.renderTokens(t[4],e,n,i);return r}},t.prototype.renderInverted=function(t,e,n,i){var o=e.lookup(t[1]);if(!o||b(o)&&0===o.length)return this.renderTokens(t[4],e,n,i)},t.prototype.indentPartial=function(t,e,n){for(var i=e.replace(/[^ \t]/g,""),o=t.split("\n"),r=0;r<o.length;r++)o[r].length&&(0<r||!n)&&(o[r]=i+o[r]);return o.join("\n")},t.prototype.renderPartial=function(t,e,n,i){if(n){var o=c(n)?n(t[1]):n[t[1]];if(null!=o){var r=t[6],a=t[5],s=t[4],p=o;return 0==a&&s&&(p=this.indentPartial(o,s,r)),this.renderTokens(this.parse(p,i),e,n,p)}}},t.prototype.unescapedValue=function(t,e){var n=e.lookup(t[1]);if(null!=n)return n},t.prototype.escapedValue=function(t,e){var n=e.lookup(t[1]);if(null!=n)return P.escape(n)},t.prototype.rawValue=function(t){return t[1]};var P={name:"mustache.js",version:"3.2.1",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,to_html:void 0,Scanner:void 0,Context:void 0,Writer:void 0},s=new t;return P.clearCache=function(){return s.clearCache()},P.parse=function(t,e){return s.parse(t,e)},P.render=function(t,e,n,i){if("string"!=typeof t)throw new TypeError('Invalid template! Template should be a "string" but "'+(b(o=t)?"array":typeof o)+'" was given as the first argument for mustache#render(template, view, partials)');var o;return s.render(t,e,n,i)},P.to_html=function(t,e,n,i){var o=P.render(t,e,n);if(!c(i))return o;i(o)},P.escape=function(t){return String(t).replace(/[&<>"'`=\/]/g,function(t){return n[t]})},P.Scanner=E,P.Context=a,P.Writer=t,P},"object"==typeof n&&void 0!==e?e.exports=o():"function"==typeof define&&define.amd?define(o):(i=i||self).Mustache=o()},{}]},{},[1]);
//# sourceMappingURL=FrontendGoogleMap.js.map
