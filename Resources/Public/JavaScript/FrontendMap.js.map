{"version":3,"sources":["FrontendMap.ts"],"names":[],"mappings":"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","file":"FrontendMap.js","sourcesContent":["/**\n * This file is developed by evoweb.\n *\n * It is free software; you can redistribute it and/or modify it under\n * the terms of the GNU General Public License, either version 2\n * of the License, or any later version.\n *\n * For the full copyright and license information, please read the\n * LICENSE.txt file that was distributed with this source code.\n */\n\nimport * as Mustache from 'mustache';\nimport * as $ from 'jquery';\nimport {MapConfiguration, Location} from \"./Interfaces\";\n\nexport default class FrontendMap {\n  public mapConfiguration: MapConfiguration;\n  public locations: Array<Location>;\n  public locationIndex: number = 0;\n  public infoWindowTemplate: string;\n\n  /**\n   * The constructor, set the class properties default values\n   */\n  constructor(mapConfiguration: MapConfiguration, locations: Array<Location>) {\n    this.mapConfiguration = mapConfiguration || {\n      active: false,\n      afterSearch: 0,\n\n      apiConsoleKey: '',\n      apiUrl: '',\n      allowSensors: false,\n      language: '',\n\n      markerIcon: '',\n      apiV3Layers: '',\n      kmlUrl: '',\n      renderSingleViewCallback: null,\n      handleCloseButtonCallback: null\n    };\n    this.locations = locations;\n\n    this.loadScript();\n  }\n\n  initializeMap() {}\n\n  initializeLayer() {}\n\n  /**\n   * Render content of the info window\n   */\n  renderInfoWindowContent(location: Location): string {\n    return Mustache.render(this.infoWindowTemplate, location.information)\n  }\n\n  createMarker(location: Location, icon: string) {}\n\n  /**\n   * Process single location\n   *\n   * @param location\n   */\n  processLocation(this: FrontendMap, location: Location) {\n    let icon = '';\n    if (location.information.icon) {\n      icon = location.information.icon;\n    } else if (this.mapConfiguration.hasOwnProperty('markerIcon')) {\n      icon = this.mapConfiguration.markerIcon;\n    }\n\n    this.locationIndex++;\n    location.information.index = this.locationIndex;\n    location.marker = this.createMarker(location, icon);\n  }\n\n  /**\n   * Initialize location marker on map\n   */\n  initializeLocations(this: FrontendMap) {\n    this.locations.map(this.processLocation.bind(this));\n  }\n\n  initializeInfoWindow() {}\n\n  closeInfoWindow() {}\n\n  openInfoWindow(this: FrontendMap, index: number) {}\n\n  /**\n   * Initialize list click events\n   */\n  initializeListEvents(this: FrontendMap) {\n    $(document).on('click', '.tx-storefinder .resultList > li', (event: Event, $field: JQuery): void => {\n      this.openInfoWindow($field.data('index'));\n    });\n  }\n\n  /**\n   * Initialize info window template\n   */\n  initializeTemplates(this: FrontendMap) {\n    this.infoWindowTemplate = $('#templateInfoWindow').html();\n    Mustache.parse(this.infoWindowTemplate);\n\n    $(document).on('click', '.tx-storefinder .infoWindow .close', (event: Event, $closeButton: JQuery): void => {\n      if (typeof this.mapConfiguration.renderSingleViewCallback === 'function') {\n        this.mapConfiguration.handleCloseButtonCallback($closeButton);\n      } else {\n        this.closeInfoWindow();\n      }\n    });\n  }\n\n  /**\n   * Post load javascript files\n   */\n  postLoadScript() {\n    this.initializeMap();\n    this.initializeLayer();\n    this.initializeLocations();\n    this.initializeInfoWindow();\n    this.initializeTemplates();\n    this.initializeListEvents();\n  }\n\n  loadScript() {}\n}\n\n"]}